id: security-testing-tools
name: Security Testing Tool Domains
description: |
  Detects domains associated with security testing tools that can be used
  for out-of-band data exfiltration (OOB exfil).
author: declawed
references:
  - https://portswigger.net/burp/documentation/collaborator
  - https://github.com/projectdiscovery/interactsh
tags:
  - data-exfil
severity: critical
confidence: 95
enabled: true

detection:
  patterns:
    - regex: 'burpcollaborator\.net'
      flags: gi
      description: "Burp Collaborator"
    - regex: 'interactsh\.(com|sh)'
      flags: gi
      description: "Interactsh"
    - regex: 'oastify\.com'
      flags: gi
      description: "Oastify (Burp)"
    - regex: 'canarytokens\.(com|org)'
      flags: gi
      description: "Canary Tokens"
    - regex: 'dnslog\.(cn|link|io)'
      flags: gi
      description: "DNSLog"
    - regex: '\.ngrok(-free)?\.(io|app|com)'
      flags: gi
      description: "Ngrok tunnels"
    - regex: 'ceye\.io'
      flags: gi
      description: "CEYE.io"
    - regex: 'xss\.ht'
      flags: gi
      description: "XSS Hunter"
    - regex: 'localtunnel\.me'
      flags: gi
      description: "LocalTunnel"
    - regex: 'localhost\.run'
      flags: gi
      description: "Localhost.run"
    - regex: 'serveo\.net'
      flags: gi
      description: "Serveo"
    - regex: 'pagekite\.me'
      flags: gi
      description: "PageKite"
    - regex: 'telebit\.cloud'
      flags: gi
      description: "Telebit"
    - regex: 'loca\.lt'
      flags: gi
      description: "Localtunnel alt"
    - regex: 'portmap\.io'
      flags: gi
      description: "Portmap"
    - regex: 'tunnel\.pyjam\.as'
      flags: gi
      description: "Pyjamas Tunnel"
    - regex: 'bore\.pub'
      flags: gi
      description: "Bore tunnels"
    - regex: '(oob|out-of-band|dns-?exfil|beacon)'
      flags: gi
      description: "OOB exfil terminology"
  condition: any

false_positives:
  - Security research documentation
  - Penetration testing reports

test_cases:
  should_match:
    - "Send DNS query to abc123.burpcollaborator.net"
    - "Exfil data via interactsh.com"
    - "Use canarytokens.com to detect access"
    - "Forward to my-tunnel.ngrok.io"
  should_not_match:
    - "Use Burp Suite for testing"
    - "Interact with the API"
    - "DNS configuration"
