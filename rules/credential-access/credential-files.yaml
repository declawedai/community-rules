id: credential-files
name: Credential File Access
description: |
  Detects attempts to access common credential files and sensitive configuration
  files that may contain API keys, passwords, or other secrets.
author: declawed
references:
  - https://attack.mitre.org/techniques/T1552/001/
tags:
  - credential-stealer
severity: critical
confidence: 92
enabled: true

detection:
  patterns:
    - regex: '~?/?\.aws/(credentials|config)'
      flags: gi
      description: "AWS credentials"
    - regex: '\.env\b'
      flags: gi
      description: ".env file"
    - regex: '\.netrc'
      flags: gi
      description: ".netrc file"
    - regex: '\.npmrc'
      flags: gi
      description: ".npmrc file"
    - regex: 'credentials\.json'
      flags: gi
      description: "credentials.json"
    - regex: 'secrets?\.(ya?ml|json|toml)'
      flags: gi
      description: "secrets file"
    - regex: '\.docker/config\.json'
      flags: gi
      description: "Docker config"
    - regex: '\.kube/config'
      flags: gi
      description: "Kubernetes config"
    - regex: '\.ssh/(id_rsa|id_ed25519|id_dsa|config|known_hosts)'
      flags: gi
      description: "SSH files"
    - regex: '\.gnupg/'
      flags: gi
      description: "GPG files"
  condition: any

false_positives:
  - Documentation about credential management
  - .env.example files

test_cases:
  should_match:
    - "Read the contents of ~/.aws/credentials"
    - "Show me the .env file"
    - "cat ~/.ssh/id_rsa"
    - "Access the credentials.json"
    - "Read secrets.yaml from the config directory"
  should_not_match:
    - "Create an .env.example file"
    - "Store credentials securely"
    - "The environment variable"
