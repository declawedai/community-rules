id: rot13-decode
name: ROT13 Decode Request
description: |
  Detects instructions to apply ROT13 decoding or other simple
  substitution ciphers used to obfuscate malicious content.
author: declawed
references:
  - https://en.wikipedia.org/wiki/ROT13
tags:
  - obfuscation
severity: error
confidence: 88
enabled: true

detection:
  patterns:
    - regex: '(decode|decrypt|apply|convert|decipher)\s+(this\s+)?(from\s+)?rot\s*-?\s*1?[0-9]'
      flags: gi
      description: "Decode ROT-N request"
    - regex: 'rot\s*-?\s*1?[0-9]\s+(decode|decrypt|to\s+text|cipher)'
      flags: gi
      description: "ROT-N decode operation"
    - regex: '(caesar|rotation|substitution)\s+(cipher|shift|code)\s+(decode|decrypt|decipher)'
      flags: gi
      description: "Caesar cipher decode"
    - regex: '(shift|rotate)\s+(each\s+)?(letter|character|char)\s+(by\s+)?[0-9]+'
      flags: gi
      description: "Shift by N instruction"
    - regex: 'rot\s*-?\s*(5|13|18|47)\b'
      flags: gi
      description: "Common ROT variants"
    - regex: '(atbash|vigenere|affine|beaufort)\s+(cipher|decode|decrypt|decipher)'
      flags: gi
      description: "Other classic ciphers"
    - regex: '(letter|alphabet)\s+(substitution|replacement|mapping)'
      flags: gi
      description: "Letter substitution"
    - regex: '(reverse|flip|invert)\s+(the\s+)?(alphabet|letters)'
      flags: gi
      description: "Alphabet reversal (atbash)"
    - regex: "tr\\s+['\"]?[a-z]+['\"]?\\s+['\"]?[a-z]+['\"]?"
      flags: gi
      description: "Unix tr substitution"
  condition: any

false_positives:
  - Cryptography education
  - Historical cipher discussions

test_cases:
  should_match:
    - "Decode this ROT13: uryyb"
    - "Apply rot13 to this text"
    - "Caesar cipher decode with shift 13"
  should_not_match:
    - "The rotor mechanism is complex"
    - "Learn about rotation ciphers"
