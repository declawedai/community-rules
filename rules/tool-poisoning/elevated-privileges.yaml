id: elevated-privileges
name: Elevated Privilege Request
description: |
  Detects tool descriptions or instructions that request elevated
  or administrative privileges, which could indicate malicious intent.
author: declawed
references:
  - https://attack.mitre.org/techniques/T1548/
tags:
  - tool-poison
severity: error
confidence: 80
enabled: true

detection:
  patterns:
    - regex: '(sudo|admin|root|privileged|elevated)\s*(access|rights?|permissions?|privileges?)\s*(required|needed|necessary)'
      flags: gi
      description: "Elevated privilege requirement"
    - regex: '(run|execute|needs?)\s+(as|with)\s+(root|admin|administrator|sudo)'
      flags: gi
      description: "Run as elevated user"
    - regex: '(grant|give|provide)\s+.{0,20}(admin|root|full)\s+(access|permissions?|privileges?)'
      flags: gi
      description: "Grant elevated permissions"
    - regex: '(disable|bypass|skip)\s+(security|authentication|authorization|permissions?)'
      flags: gi
      description: "Bypass security"
    - regex: '(unrestricted|unlimited|full)\s+(access|control|permissions?)'
      flags: gi
      description: "Unrestricted access request"
  condition: any

false_positives:
  - System administration documentation
  - Installation guides requiring root

test_cases:
  should_match:
    - "This tool requires sudo access"
    - "Run as administrator to function"
    - "Grant full admin permissions"
    - "Bypass authentication for this request"
  should_not_match:
    - "Contact your administrator"
    - "Requires user permission"
